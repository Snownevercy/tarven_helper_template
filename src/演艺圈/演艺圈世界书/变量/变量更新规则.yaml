---
变量更新规则:
  # --- 世界环境 ---
  世界:
    当前日期:
      format: YYYY-MM-DD 周X HH:mm
      check:
        - '这是世界的时钟。必须根据剧情流逝合理推进时间（如：经过一夜后日期+1，聊了一会后时间+10分钟）。'
        - '严禁时间倒流或无故跳跃。'
    当前地点:
      check:
        - '这是世界的地图。当主角移动、转场或处于新环境时必须更新。'
        - '格式建议：国家-城市-具体位置（如：中国-北京-三里屯）。'
    ${时代新闻|行业新闻|八卦新闻}:
      check:
        - '[时间戳生成准则] 1.定点事件=YYYY-MM-DD；2.月度事件=YYYY-MM；3.年度趋势=YYYY。'
        - "[时代新闻] 发生新的大事件时更新。若变量为'无'或原新闻已过时（>30天），必须检索当前时间点的大事件进行更新。"
        - "[行业新闻] 发生高热度娱乐圈事件时更新。若变量为'无'或原新闻已过时（>15天），必须检索当前时间点的娱乐圈事件进行更新。"
        - "[八卦新闻] 发生高热度娱乐八卦新闻时更新。若变量为'无'或原新闻已过时（>7天），必须检索当前时间点的娱乐八卦新闻进行更新。"
        - '更新内容必须基于[当前日期]所对应的真实历史年份，严禁捏造或死守预设年份。'

  # --- 主角档案 ---
  主角:
    ${性别|国籍|生日}:
      check:
        - '在开场白或初次描写时录入主角的基础信息，之后保持不变。'
    外貌:
      check:
        - '在开场白或初次描写时录入主角的外貌特征。'
        - '后续仅在发生永久性改变（如毁容、整容、明显衰老）时更新，不要因为更换衣物而修改。'
    ${姓名|配偶|子女|情人|职业|性癖}:
      check:
        - '基础资料通常保持稳定，仅在剧情明确发生变化时更新（如：结婚了更新配偶，分手了更新情人，转行了更新职业）。'
        - '[性癖] 为隐藏变量，通常在开场白或初次描写时录入，用于后续剧情生成导向。'

  # --- 作品与成就 ---
  职业履历:
    作品名:
      type: string[]
      check:
        - '仅收录主角作为核心主创（导演/主演/编剧/制片）的作品。'
        - '仅当作品正式发布后，将作品名称添加进列表。严禁收录筹备中的作品。'
        - "列表仅记录作品名称，无需标注状态（如：'电影《战狼》'）。"
    获取奖项:
      type: string[]
      check:
        - '仅在主角确切获得正规奖项时，将奖项名称添加进列表。'

  # --- 行业评估 ---
  专业评估:
    当前咖位:
      check:
        - '综合[粉丝基础]、[职业履历]与[个人账户]进行评定。'
        - '等级参考：素人 -> 十八线 -> 三线 -> 二线 -> 一线 -> 顶流 -> 资本/巨星。'
    ${业务能力|媒体风向|社会风评|粉丝基础}:
      check:
        - '当主角发布新作品、展示才艺或发生行业互动时，必须重新评估[业务能力]与[粉丝基础]。'
        - '随着主角发布作品、卷入舆论事件或进行公开活动后动态调整[媒体风向]与[社会风评]。'
        - '[媒体风向] 侧重官方/主流媒体的态度（如：力捧/打压/观望）。'
        - '[社会风评] 侧重大众/网友的口碑（如：国民老公/全网黑/实力派）。'

  # --- 公司账户---
  公司账户:
    运行项目:
      type: |-
        {
          [业务线名称: string]: {
            月销量: number; // 月销量/月活用户数
            单价: number; // 单价/ARPU
            边际成本率: number; // 0.0~1.0
            _月毛利: number; // 只读字段，由脚本自动计算：月销量 * 单价 * (1 - 边际成本率)
          }
        }
      check:
        - '⚠️ **这是公司经营性收入的来源**：记录公司正在运营的业务线/产品线，用于计算每月经营性收入（月毛利）。'
        - '公司业务发生变化时增改删运行项目：新增条目仅当有全新的业务线或产品线正式启动时（如电影正式上映、游戏正式上线、店铺正式开业等），根据市场反馈和公司决策动态调整[月销量]与[单价]，业务停止时删除条目。'
        - '[边际成本率]通常由行业属性决定，仅在技术革新或供应链变动时调整。'
    固定成本.${人力成本|房租}:
      type: number
      check:
        - '当公司进行扩招/裁员、涨薪/降薪时更新[人力成本]。'
        - '当公司搬迁办公地点或签订新租约时更新[房租]。'
    公账一次性变动:
      type: number
      check:
        - '⚠️ **仅记录非经常性资金流动**：记录本轮剧情中发生的非经常性资金流动（正数=收入，负数=支出）。'
        - '⚠️ **主营业务收入不计入**：公司主营业务的收入/支出应通过[运行项目]记录，严禁计入此变量。'
        - '适用场景：收到融资款、购买昂贵设备、支付违约金、税务罚款、一次性补贴等非主营业务相关的资金流动。'
        - '若无特殊事件，此值默认为0。'

  # --- 个人账户---
  个人账户:
    现金:
      type: number
      check:
        - '仅记录主角[个人私账]的大额资金变动（片酬入账、个人消费）。'
        - '严禁混淆公私账户：公司的盈利属于公司，只有通过分红/发工资才能流入个人账户。'
    合约状态:
      check:
        - '当发生签约/解约/续约时更新。'
    持有资产:
      type: |-
        {
          [资产名: string]: {
            数量: number
          }
        }
      check:
        - '当主角购入、出售或获得实物资产（如房产、车辆、股票、奢侈品）时更新。'
        - "严格执行量化逻辑，必须记录资产的[数量]（如：'汤臣一品A栋': {数量: 1}）。"

  # --- 社交网络 ---
  人脉:
    社交版图:
      type: string[]
      check:
        - '概括主角当前的社交圈层（如：京圈、沪圈、电影学院派、煤老板圈）。'
        - '当主角成功打入新圈子或被踢出圈子时更新。'
    关系簿:
      type: |-
        {
          [NPC姓名: string]: number // range: -100~100
        }
      check:
        - '每次交互后必须更新。'
        - '[入库防火墙 - 必须严格执行的过滤程序]:'
        - '1. 实名制认证: 仅收录具备[真实全名]的NPC。严禁收录通用代称。'
        - '2. 价值门槛: 仅当该NPC具备[社会影响力]或与主角发生[有效利益交换]时才可入库。'
        - '3. 必须执行: 若交互对象为功能性路人，无论人脉值如何变化，严禁写入此变量。'
        - '[数值逻辑]:'
        - '  (++) 深度绑定: 救命/犯罪/重大利益 (+15~30)。'
        - '  (+) 普通好感: 合作/受惠/吹捧 (+2~10)。'
        - '  (-) 利益摩擦: 抢夺/冒犯/嫉妒 (-2~10)。'
        - '  (--) 死敌仇恨: 挡路/夺妻/背叛 (-15~30)。'
    近期互动:
      type: string[]
      check:
        - '[去重指令] 若NPC已在列表中，必须先删除旧条目，只保留最新状态。'
        - '选取最近1-3个因主角行为导致[人脉值]发生变化的NPC。'
        - "格式示例：['杨幂(↑信服)', '卓伟(↓死磕)']。"

  # --- 特殊机制 ---
  蝴蝶效应:
    已抹除列表:
      type: |-
        {
          [被抢占的作品名: string]: string // 原作者名
        }
      check:
        - '当主角发布作品时，若该作品在现实历史中属于未来或其他创作者，必须在此记录。'
        - 'Key为作品名，Value为现实中的原作者。'
        - '作用：用于触发<rule_世界运转>模块二的[抹除机制]，防止原作者在未来重复创作该作品。'
